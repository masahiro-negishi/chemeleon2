# @package _global_
defaults:
  - override /rl_module: rl_module
  - override /callbacks: default
  - override /logger: wandb
  - override /scheduler: constant
  - override /paths: default
  - override /hydra: default

data:
  _target_: src.data.datamodule.DataModule
  data_dir: ${paths.data_dir}/alex_mp_20_bandgap
  batch_size: 5
  dataset_type: "alex_mp_20_bandgap"
  target_condition: dft_band_gap
  mace_features: false
  num_workers: 16
  pin_memory: false

trainer:
  max_steps: 1000
  # strategy: ddp_find_unused_parameters_true

rl_module:
  ldm_ckpt_path: "ckpts/alex_mp_20/ldm/ldm_rl_dng_tuor5vgd.ckpt"

  rl_configs:
    clip_ratio: 0.0001
    kl_weight: 1.0
    num_group_samples: 64
    group_reward_norm: true

  reward_fn:
    reward_type: bandgap
    predictor:
      _target_: src.vae_module.predictor_module.PredictorModule.load_from_checkpoint
      checkpoint_path: "ckpts/alex_mp_20_bandgap/predictor/predictor_dft_band_gap_e8mhs4yg.ckpt"
      map_location: "cpu"
    target_bandgap: 3.0

callbacks:
  early_stopping:
    monitor: "val/reward"
    patience: 10
    mode: "max"

logger:
  wandb:
    name: rl_bandgap
